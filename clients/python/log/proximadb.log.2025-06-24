2025-06-24T19:18:48.203122Z  INFO proximadb_server: src/bin/server.rs:78: 🔧 Initializing hardware detection...
2025-06-24T19:18:48.203332Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:175: 🔍 Detecting hardware capabilities...
2025-06-24T19:18:48.203340Z DEBUG proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:203: Detecting CPU capabilities...
2025-06-24T19:18:48.203514Z DEBUG proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:267: Detecting GPU capabilities...
2025-06-24T19:18:48.204079Z DEBUG proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:307: Detecting memory information...
2025-06-24T19:18:48.204110Z DEBUG proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:327: Determining optimization paths...
2025-06-24T19:18:48.204112Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:398: 🔧 Hardware Detection Complete:
2025-06-24T19:18:48.204114Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:399:   CPU: Unknown CPU (10 cores, 10 threads)
2025-06-24T19:18:48.204116Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:403:   SIMD: Neon (SSE:false AVX:false AVX2:false FMA:false)
2025-06-24T19:18:48.204118Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:426:   Preferred Backend: Cpu { simd_level: Neon }
2025-06-24T19:18:48.204120Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:427:   Bulk Insert Batch Size: 250
2025-06-24T19:18:48.204122Z  WARN proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:437: ⚠️  CPU lacks AVX support - performance may be limited
2025-06-24T19:18:48.204898Z  INFO proximadb_server: src/bin/server.rs:88: Configuration file not found, using defaults
2025-06-24T19:18:48.205388Z  INFO proximadb_server: src/bin/server.rs:103: Starting ProximaDB server with config: Config { server: ServerConfig { node_id: "proximadb-node-1", bind_address: "0.0.0.0", port: 5678, data_dir: "/data/proximadb/1" }, storage: StorageConfig { data_dirs: ["/data/proximadb/1", "/data/proximadb/2"], wal_dir: "/data/proximadb/1/wal", storage_layout: StorageLayoutConfig { base_paths: [StorageBasePath { base_dir: "/data/proximadb", instance_id: 1, mount_point: Some("/data"), disk_type: NvmeSsd { max_iops: 100000 }, capacity_config: CapacityConfig { max_wal_size_mb: Some(2048), max_storage_size_mb: None, metadata_reserved_mb: 512, warning_threshold_percent: 85.0 } }, StorageBasePath { base_dir: "/data/proximadb", instance_id: 2, mount_point: Some("/data2"), disk_type: SataSsd { max_iops: 75000 }, capacity_config: CapacityConfig { max_wal_size_mb: Some(2048), max_storage_size_mb: None, metadata_reserved_mb: 0, warning_threshold_percent: 85.0 } }], node_instance: 1, assignment_strategy: HashBased, temp_config: TempDirectoryConfig { use_same_directory: true, temp_suffix: "___temp", compaction_suffix: "___compaction", flush_suffix: "___flushed", cleanup_on_startup: true } }, mmap_enabled: true, lsm_config: LsmConfig { memtable_size_mb: 64, level_count: 7, compaction_threshold: 4, block_size_kb: 64 }, cache_size_mb: 2048, bloom_filter_bits: 12, filesystem_config: FilesystemConfig { enable_write_strategy_cache: true, temp_strategy: SameDirectory, atomic_config: AtomicOperationsConfig { enable_local_atomic: true, enable_object_store_atomic: true, cleanup_temp_on_startup: true } }, metadata_backend: None }, consensus: ConsensusConfig { node_id: Some(1), cluster_peers: [], election_timeout_ms: 5000, heartbeat_interval_ms: 1000, snapshot_threshold: 1000 }, api: ApiConfig { grpc_port: 5679, rest_port: 5678, max_request_size_mb: 64, timeout_seconds: 30, enable_tls: Some(false) }, monitoring: MonitoringConfig { metrics_enabled: true, log_level: "info" }, tls: None }
2025-06-24T19:18:48.205399Z  INFO proximadb: src/lib.rs:71: 🚀 ProximaDB::new - STARTING database initialization
2025-06-24T19:18:48.207686Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:177: 🚀 AvroWalStrategy::initialize - Starting initialization
2025-06-24T19:18:48.207691Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:178: 📋 Config details:
2025-06-24T19:18:48.207808Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:179:   - memtable_type: Art
2025-06-24T19:18:48.207811Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:180:   - compression: Snappy
2025-06-24T19:18:48.207813Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:181:   - memory_flush_size_bytes: 1048576
2025-06-24T19:18:48.207815Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:185:   - data_directories: 1 dirs
2025-06-24T19:18:48.208019Z  INFO proximadb::storage::wal::memtable::art: src/storage/wal/memtable/art.rs:451: ✅ ART (Adaptive Radix Tree) memtable initialized for space efficiency and high concurrency
2025-06-24T19:18:48.208379Z  INFO proximadb::storage::wal::avro: src/storage/wal/avro.rs:195: ✅ Avro WAL strategy initialized
2025-06-24T19:18:48.208384Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:196: ✅ AvroWalStrategy::initialize - Initialization complete
2025-06-24T19:18:48.208390Z DEBUG proximadb::storage::wal: src/storage/wal/mod.rs:228: 🚀 Creating WalManager with strategy: Avro
2025-06-24T19:18:48.208461Z DEBUG proximadb::storage::wal: src/storage/wal/mod.rs:232: 📋 WAL Config: strategy_type=Avro, memtable_type=Art
2025-06-24T19:18:48.208466Z DEBUG proximadb::storage::wal: src/storage/wal/mod.rs:237: 💾 Multi-disk config: 1 directories, distribution=LoadBalanced
2025-06-24T19:18:48.208469Z  INFO proximadb::storage::engine: src/storage/engine.rs:119: 📂 StorageEngine: Metadata operations delegated to SharedServices
2025-06-24T19:18:48.208472Z  INFO proximadb: src/lib.rs:73: ✅ ProximaDB::new - Storage engine created successfully
2025-06-24T19:18:48.208560Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:148: 📡 HTTP Server Configuration:
2025-06-24T19:18:48.208656Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:153:   🌐 Non-TLS Mode: ENABLED on 0.0.0.0:5678
2025-06-24T19:18:48.208658Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:162:   📍 Services: REST=true, Dashboard=true, Metrics=true, Health=true
2025-06-24T19:18:48.208660Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:301: 🔗 gRPC Server Configuration:
2025-06-24T19:18:48.208662Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:306:   🌐 Non-TLS Mode: ENABLED on 0.0.0.0:5679
2025-06-24T19:18:48.208720Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:315:   📍 Features: gRPC=true, Reflection=true, MaxMsgSize=4MB
2025-06-24T19:18:48.242621Z  INFO proximadb: src/lib.rs:112: 🔧 ProximaDB::new: Creating SharedServices with metadata config: None
2025-06-24T19:18:48.242819Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:294: 🔧 SharedServices: Initializing business logic hub for ALL protocols
2025-06-24T19:18:48.242824Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:340: 📂 SharedServices: Using default metadata configuration
2025-06-24T19:18:48.242827Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:344: 📁 SharedServices: Unified metadata backend URL: file://./data
2025-06-24T19:18:48.242847Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:333: 🗃️ Creating FilestoreMetadataBackend
2025-06-24T19:18:48.242849Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:334: 📁 Filestore URL: file://./data
2025-06-24T19:18:48.243469Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:345: 📁 FilestoreMetadataBackend: Working in root directory specified by URL: file://./data
2025-06-24T19:18:48.244566Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:385: 🔄 Starting ATOMIC recovery...
2025-06-24T19:18:48.244571Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:386: 📂 Filestore URL: file://./data
2025-06-24T19:18:48.244573Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:387: 📁 Metadata path: 
2025-06-24T19:18:48.244575Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:392: 🔒 Recovery lock acquired - API requests blocked
2025-06-24T19:18:48.244577Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:398: 📸 Loading latest snapshot...
2025-06-24T19:18:48.244581Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:434: 📁 Snapshot path: snapshots/current_collections.avro
2025-06-24T19:18:48.244641Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:460: ❌ No snapshot file found at: snapshots/current_collections.avro
2025-06-24T19:18:48.244644Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:400: 📸 Loaded 0 collections from snapshot
2025-06-24T19:18:48.244645Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:406: 🔄 Replaying incremental operations...
2025-06-24T19:18:48.245174Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:408: 🔄 Replayed 0 operations
2025-06-24T19:18:48.245180Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:409: 📊 Final memtable size: 0
2025-06-24T19:18:48.245184Z  INFO proximadb::storage::metadata::single_index: src/storage/metadata/single_index.rs:244: SingleCollectionIndex rebuilt with 0 collections
2025-06-24T19:18:48.246310Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:619: 💾 Atomic write with optimized strategy: snapshots/current_collections.avro
2025-06-24T19:18:48.246760Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:621: ✅ Optimized atomic write completed
2025-06-24T19:18:48.246765Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:426: ✅ Recovery completed in 2.188792ms
2025-06-24T19:18:48.246774Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:379: ✅ FilestoreMetadataBackend initialized
2025-06-24T19:18:48.246805Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:146: 🏗️ Creating UnifiedAvroService with shared WAL manager
2025-06-24T19:18:48.246807Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:147: 🔧 WAL Strategy: Avro, Memtable: BTree
2025-06-24T19:18:48.246808Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:89: 🚀 Initializing UnifiedAvroService with binary Avro operations
2025-06-24T19:18:48.246810Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:90: 📋 Service Config: WAL strategy=Avro, memtable=BTree, schema_version=1
2025-06-24T19:18:48.246812Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:157: 🔧 Creating Vector Storage Coordinator with VIPER engine
2025-06-24T19:18:48.246820Z  INFO proximadb::storage::vector::coordinator: src/storage/vector/coordinator.rs:356: 🔧 Registered storage engine: VIPER
2025-06-24T19:18:48.246822Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:184: ✅ Vector Storage Coordinator created with VIPER engine
2025-06-24T19:18:48.246824Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:370: 🔄 SharedServices: Starting metadata recovery from WAL
2025-06-24T19:18:48.246826Z  INFO proximadb::storage::engine: src/storage/engine.rs:430: 📊 Extracting collection metadata from recovered WAL entries
2025-06-24T19:18:48.246869Z  INFO proximadb::storage::engine: src/storage/engine.rs:438: 📊 WAL stats: 0 total entries across 0 collections
2025-06-24T19:18:48.246872Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection test_persistence_collection_1 from memtable
2025-06-24T19:18:48.246874Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection test_persistence_collection_2 from memtable
2025-06-24T19:18:48.246876Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection embeddings from memtable
2025-06-24T19:18:48.246878Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection documents from memtable
2025-06-24T19:18:48.246880Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection vectors from memtable
2025-06-24T19:18:48.246882Z  INFO proximadb::storage::engine: src/storage/engine.rs:494: ✅ Extracted metadata for 0 collections from WAL
2025-06-24T19:18:48.246884Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:415: 📋 SharedServices: No collections found in WAL to restore
2025-06-24T19:18:48.246885Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:418: ✅ SharedServices: Business logic hub ready for ALL protocols (gRPC, REST, WebSocket, etc.)
2025-06-24T19:18:48.246887Z  INFO proximadb: src/lib.rs:119: ✅ ProximaDB::new: SharedServices created successfully
2025-06-24T19:18:48.246889Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:449: 🚀 MultiServer: Initializing network orchestrator
2025-06-24T19:18:48.246890Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:450: 📡 MultiServer: gRPC port: 5679, REST port: 5678
2025-06-24T19:18:48.246892Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:452: 🔒 MultiServer: TLS enabled: false
2025-06-24T19:18:48.246895Z  INFO proximadb::storage::engine: src/storage/engine.rs:408: 🔄 Starting WAL recovery
2025-06-24T19:18:48.246897Z  INFO proximadb::storage::wal::avro: src/storage/wal/avro.rs:582: 🔄 WAL RECOVERY: Starting Avro WAL recovery
2025-06-24T19:18:48.246898Z  INFO proximadb::storage::wal::avro: src/storage/wal/avro.rs:587: 📂 WAL RECOVERY: Found 0 collections to recover
2025-06-24T19:18:48.246900Z  INFO proximadb::storage::wal::avro: src/storage/wal/avro.rs:618: ✅ WAL RECOVERY: Recovered 0 total entries from disk
2025-06-24T19:18:48.246901Z  INFO proximadb::storage::engine: src/storage/engine.rs:413: ✅ WAL recovery completed successfully, recovered 0 entries
2025-06-24T19:18:48.247008Z DEBUG proximadb::storage::engine: src/storage/engine.rs:399: TODO: Initialize search index for collection wal via SharedServices
2025-06-24T19:18:48.247050Z  INFO proximadb::storage::engine: src/storage/engine.rs:585: 🔍 Preloading collection metadata cache...
2025-06-24T19:18:48.247052Z  INFO proximadb::storage::engine: src/storage/engine.rs:595: 🔍 Preloaded 0 collections into metadata cache
2025-06-24T19:18:48.247055Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:463: 🚀 Starting ProximaDB Multi-Server: gRPC:5679 + REST:5678
2025-06-24T19:18:48.247056Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:470: 🔗 Starting gRPC Server on port 5679
2025-06-24T19:18:48.247058Z  INFO proximadb::network::grpc::service: src/network/grpc/service.rs:135: 🚀 Creating ProximaDbGrpcService with shared services (multi-server pattern)
2025-06-24T19:18:48.247068Z DEBUG proximadb::network::multi_server: src/network/multi_server.rs:485: Adding gRPC reflection service
2025-06-24T19:18:48.247473Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:506: ✅ gRPC Server started on 0.0.0.0:5679
2025-06-24T19:18:48.247475Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:511: 📡 Starting REST Server on port 5678
2025-06-24T19:18:48.247478Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:531: ✅ REST Server started on 0.0.0.0:5678
2025-06-24T19:18:48.247480Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:536: 🎯 Multi-Server started successfully: gRPC:5679 + REST:5678
2025-06-24T19:18:48.247482Z  INFO proximadb_server: src/bin/server.rs:114: ProximaDB server started successfully
2025-06-24T19:18:48.247679Z ERROR proximadb::network::multi_server: src/network/multi_server.rs:501: gRPC server error: transport error
2025-06-24T19:18:48.247695Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:68: 🌐 Starting REST server on 0.0.0.0:5678
2025-06-24T19:18:48.247699Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:70: ✅ REST server listening on 0.0.0.0:5678
2025-06-24T19:18:48.247702Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:71: 📋 Available endpoints:
2025-06-24T19:18:48.247704Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:72:    GET    /health                           - Health check
2025-06-24T19:18:48.247706Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:73:    POST   /collections                      - Create collection
2025-06-24T19:18:48.247707Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:74:    GET    /collections                      - List collections
2025-06-24T19:18:48.247709Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:75:    GET    /collections/:id                  - Get collection
2025-06-24T19:18:48.247710Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:76:    DELETE /collections/:id                  - Delete collection
2025-06-24T19:18:48.247712Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:77:    POST   /collections/:id/vectors          - Insert vector
2025-06-24T19:18:48.247713Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:78:    GET    /collections/:id/vectors/:vid     - Get vector
2025-06-24T19:18:48.247715Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:79:    PUT    /collections/:id/vectors/:vid     - Update vector
2025-06-24T19:18:48.247716Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:80:    DELETE /collections/:id/vectors/:vid     - Delete vector
2025-06-24T19:18:48.247718Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:81:    POST   /collections/:id/search           - Search vectors
2025-06-24T19:18:48.247719Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:82:    POST   /collections/:id/vectors/batch    - Batch insert
2025-06-24T19:18:49.666236Z  INFO proximadb_server: src/bin/server.rs:78: 🔧 Initializing hardware detection...
2025-06-24T19:18:49.667180Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:175: 🔍 Detecting hardware capabilities...
2025-06-24T19:18:49.667251Z DEBUG proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:203: Detecting CPU capabilities...
2025-06-24T19:18:49.668564Z DEBUG proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:267: Detecting GPU capabilities...
2025-06-24T19:18:49.670222Z DEBUG proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:307: Detecting memory information...
2025-06-24T19:18:49.670466Z DEBUG proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:327: Determining optimization paths...
2025-06-24T19:18:49.670550Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:398: 🔧 Hardware Detection Complete:
2025-06-24T19:18:49.670671Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:399:   CPU: Unknown CPU (10 cores, 10 threads)
2025-06-24T19:18:49.670769Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:403:   SIMD: Neon (SSE:false AVX:false AVX2:false FMA:false)
2025-06-24T19:18:49.670858Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:426:   Preferred Backend: Cpu { simd_level: Neon }
2025-06-24T19:18:49.670909Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:427:   Bulk Insert Batch Size: 250
2025-06-24T19:18:49.670989Z  WARN proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:437: ⚠️  CPU lacks AVX support - performance may be limited
2025-06-24T19:18:49.671958Z  INFO proximadb_server: src/bin/server.rs:88: Configuration file not found, using defaults
2025-06-24T19:18:49.672264Z  INFO proximadb_server: src/bin/server.rs:103: Starting ProximaDB server with config: Config { server: ServerConfig { node_id: "proximadb-node-1", bind_address: "0.0.0.0", port: 5678, data_dir: "/data/proximadb/1" }, storage: StorageConfig { data_dirs: ["/data/proximadb/1", "/data/proximadb/2"], wal_dir: "/data/proximadb/1/wal", storage_layout: StorageLayoutConfig { base_paths: [StorageBasePath { base_dir: "/data/proximadb", instance_id: 1, mount_point: Some("/data"), disk_type: NvmeSsd { max_iops: 100000 }, capacity_config: CapacityConfig { max_wal_size_mb: Some(2048), max_storage_size_mb: None, metadata_reserved_mb: 512, warning_threshold_percent: 85.0 } }, StorageBasePath { base_dir: "/data/proximadb", instance_id: 2, mount_point: Some("/data2"), disk_type: SataSsd { max_iops: 75000 }, capacity_config: CapacityConfig { max_wal_size_mb: Some(2048), max_storage_size_mb: None, metadata_reserved_mb: 0, warning_threshold_percent: 85.0 } }], node_instance: 1, assignment_strategy: HashBased, temp_config: TempDirectoryConfig { use_same_directory: true, temp_suffix: "___temp", compaction_suffix: "___compaction", flush_suffix: "___flushed", cleanup_on_startup: true } }, mmap_enabled: true, lsm_config: LsmConfig { memtable_size_mb: 64, level_count: 7, compaction_threshold: 4, block_size_kb: 64 }, cache_size_mb: 2048, bloom_filter_bits: 12, filesystem_config: FilesystemConfig { enable_write_strategy_cache: true, temp_strategy: SameDirectory, atomic_config: AtomicOperationsConfig { enable_local_atomic: true, enable_object_store_atomic: true, cleanup_temp_on_startup: true } }, metadata_backend: None }, consensus: ConsensusConfig { node_id: Some(1), cluster_peers: [], election_timeout_ms: 5000, heartbeat_interval_ms: 1000, snapshot_threshold: 1000 }, api: ApiConfig { grpc_port: 5679, rest_port: 5678, max_request_size_mb: 64, timeout_seconds: 30, enable_tls: Some(false) }, monitoring: MonitoringConfig { metrics_enabled: true, log_level: "info" }, tls: None }
2025-06-24T19:18:49.672351Z  INFO proximadb: src/lib.rs:71: 🚀 ProximaDB::new - STARTING database initialization
2025-06-24T19:18:49.673403Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:177: 🚀 AvroWalStrategy::initialize - Starting initialization
2025-06-24T19:18:49.673501Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:178: 📋 Config details:
2025-06-24T19:18:49.673579Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:179:   - memtable_type: Art
2025-06-24T19:18:49.673625Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:180:   - compression: Snappy
2025-06-24T19:18:49.673685Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:181:   - memory_flush_size_bytes: 1048576
2025-06-24T19:18:49.673729Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:185:   - data_directories: 1 dirs
2025-06-24T19:18:49.673910Z  INFO proximadb::storage::wal::memtable::art: src/storage/wal/memtable/art.rs:451: ✅ ART (Adaptive Radix Tree) memtable initialized for space efficiency and high concurrency
2025-06-24T19:18:49.674839Z  INFO proximadb::storage::wal::avro: src/storage/wal/avro.rs:195: ✅ Avro WAL strategy initialized
2025-06-24T19:18:49.674896Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:196: ✅ AvroWalStrategy::initialize - Initialization complete
2025-06-24T19:18:49.674968Z DEBUG proximadb::storage::wal: src/storage/wal/mod.rs:228: 🚀 Creating WalManager with strategy: Avro
2025-06-24T19:18:49.675040Z DEBUG proximadb::storage::wal: src/storage/wal/mod.rs:232: 📋 WAL Config: strategy_type=Avro, memtable_type=Art
2025-06-24T19:18:49.675105Z DEBUG proximadb::storage::wal: src/storage/wal/mod.rs:237: 💾 Multi-disk config: 1 directories, distribution=LoadBalanced
2025-06-24T19:18:49.675224Z  INFO proximadb::storage::engine: src/storage/engine.rs:119: 📂 StorageEngine: Metadata operations delegated to SharedServices
2025-06-24T19:18:49.675323Z  INFO proximadb: src/lib.rs:73: ✅ ProximaDB::new - Storage engine created successfully
2025-06-24T19:18:49.675425Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:148: 📡 HTTP Server Configuration:
2025-06-24T19:18:49.675506Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:153:   🌐 Non-TLS Mode: ENABLED on 0.0.0.0:5678
2025-06-24T19:18:49.675568Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:162:   📍 Services: REST=true, Dashboard=true, Metrics=true, Health=true
2025-06-24T19:18:49.675640Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:301: 🔗 gRPC Server Configuration:
2025-06-24T19:18:49.675711Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:306:   🌐 Non-TLS Mode: ENABLED on 0.0.0.0:5679
2025-06-24T19:18:49.675782Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:315:   📍 Features: gRPC=true, Reflection=true, MaxMsgSize=4MB
2025-06-24T19:18:49.698160Z  INFO proximadb: src/lib.rs:112: 🔧 ProximaDB::new: Creating SharedServices with metadata config: None
2025-06-24T19:18:49.698334Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:294: 🔧 SharedServices: Initializing business logic hub for ALL protocols
2025-06-24T19:18:49.698391Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:340: 📂 SharedServices: Using default metadata configuration
2025-06-24T19:18:49.698445Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:344: 📁 SharedServices: Unified metadata backend URL: file://./data
2025-06-24T19:18:49.698517Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:333: 🗃️ Creating FilestoreMetadataBackend
2025-06-24T19:18:49.698564Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:334: 📁 Filestore URL: file://./data
2025-06-24T19:18:49.699891Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:345: 📁 FilestoreMetadataBackend: Working in root directory specified by URL: file://./data
2025-06-24T19:18:49.700970Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:385: 🔄 Starting ATOMIC recovery...
2025-06-24T19:18:49.701041Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:386: 📂 Filestore URL: file://./data
2025-06-24T19:18:49.701095Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:387: 📁 Metadata path: 
2025-06-24T19:18:49.701201Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:392: 🔒 Recovery lock acquired - API requests blocked
2025-06-24T19:18:49.701260Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:398: 📸 Loading latest snapshot...
2025-06-24T19:18:49.701325Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:434: 📁 Snapshot path: snapshots/current_collections.avro
2025-06-24T19:18:49.701507Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:439: 📄 Snapshot file exists, reading...
2025-06-24T19:18:49.701823Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:441: 📊 Snapshot file size: 0 bytes
2025-06-24T19:18:49.701899Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:457: 📭 Snapshot file is empty
2025-06-24T19:18:49.701951Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:400: 📸 Loaded 0 collections from snapshot
2025-06-24T19:18:49.701995Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:406: 🔄 Replaying incremental operations...
2025-06-24T19:18:49.702385Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:408: 🔄 Replayed 0 operations
2025-06-24T19:18:49.702451Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:409: 📊 Final memtable size: 0
2025-06-24T19:18:49.702522Z  INFO proximadb::storage::metadata::single_index: src/storage/metadata/single_index.rs:244: SingleCollectionIndex rebuilt with 0 collections
2025-06-24T19:18:49.704955Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:619: 💾 Atomic write with optimized strategy: snapshots/current_collections.avro
2025-06-24T19:18:49.705472Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:621: ✅ Optimized atomic write completed
2025-06-24T19:18:49.705641Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:426: ✅ Recovery completed in 4.38825ms
2025-06-24T19:18:49.705704Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:379: ✅ FilestoreMetadataBackend initialized
2025-06-24T19:18:49.705762Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:146: 🏗️ Creating UnifiedAvroService with shared WAL manager
2025-06-24T19:18:49.705804Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:147: 🔧 WAL Strategy: Avro, Memtable: BTree
2025-06-24T19:18:49.705890Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:89: 🚀 Initializing UnifiedAvroService with binary Avro operations
2025-06-24T19:18:49.705938Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:90: 📋 Service Config: WAL strategy=Avro, memtable=BTree, schema_version=1
2025-06-24T19:18:49.705980Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:157: 🔧 Creating Vector Storage Coordinator with VIPER engine
2025-06-24T19:18:49.706212Z  INFO proximadb::storage::vector::coordinator: src/storage/vector/coordinator.rs:356: 🔧 Registered storage engine: VIPER
2025-06-24T19:18:49.706279Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:184: ✅ Vector Storage Coordinator created with VIPER engine
2025-06-24T19:18:49.706332Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:370: 🔄 SharedServices: Starting metadata recovery from WAL
2025-06-24T19:18:49.706380Z  INFO proximadb::storage::engine: src/storage/engine.rs:430: 📊 Extracting collection metadata from recovered WAL entries
2025-06-24T19:18:49.706487Z  INFO proximadb::storage::engine: src/storage/engine.rs:438: 📊 WAL stats: 0 total entries across 0 collections
2025-06-24T19:18:49.706535Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection test_persistence_collection_1 from memtable
2025-06-24T19:18:49.706580Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection test_persistence_collection_2 from memtable
2025-06-24T19:18:49.706646Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection embeddings from memtable
2025-06-24T19:18:49.706709Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection documents from memtable
2025-06-24T19:18:49.706764Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection vectors from memtable
2025-06-24T19:18:49.706811Z  INFO proximadb::storage::engine: src/storage/engine.rs:494: ✅ Extracted metadata for 0 collections from WAL
2025-06-24T19:18:49.706871Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:415: 📋 SharedServices: No collections found in WAL to restore
2025-06-24T19:18:49.706921Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:418: ✅ SharedServices: Business logic hub ready for ALL protocols (gRPC, REST, WebSocket, etc.)
2025-06-24T19:18:49.706963Z  INFO proximadb: src/lib.rs:119: ✅ ProximaDB::new: SharedServices created successfully
2025-06-24T19:18:49.707006Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:449: 🚀 MultiServer: Initializing network orchestrator
2025-06-24T19:18:49.707046Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:450: 📡 MultiServer: gRPC port: 5679, REST port: 5678
2025-06-24T19:18:49.707120Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:452: 🔒 MultiServer: TLS enabled: false
2025-06-24T19:18:49.707170Z  INFO proximadb::storage::engine: src/storage/engine.rs:408: 🔄 Starting WAL recovery
2025-06-24T19:18:49.707217Z  INFO proximadb::storage::wal::avro: src/storage/wal/avro.rs:582: 🔄 WAL RECOVERY: Starting Avro WAL recovery
2025-06-24T19:18:49.707260Z  INFO proximadb::storage::wal::avro: src/storage/wal/avro.rs:587: 📂 WAL RECOVERY: Found 0 collections to recover
2025-06-24T19:18:49.707302Z  INFO proximadb::storage::wal::avro: src/storage/wal/avro.rs:618: ✅ WAL RECOVERY: Recovered 0 total entries from disk
2025-06-24T19:18:49.707342Z  INFO proximadb::storage::engine: src/storage/engine.rs:413: ✅ WAL recovery completed successfully, recovered 0 entries
2025-06-24T19:18:49.707576Z DEBUG proximadb::storage::engine: src/storage/engine.rs:399: TODO: Initialize search index for collection wal via SharedServices
2025-06-24T19:18:49.707716Z  INFO proximadb::storage::engine: src/storage/engine.rs:585: 🔍 Preloading collection metadata cache...
2025-06-24T19:18:49.707791Z  INFO proximadb::storage::engine: src/storage/engine.rs:595: 🔍 Preloaded 0 collections into metadata cache
2025-06-24T19:18:49.707848Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:463: 🚀 Starting ProximaDB Multi-Server: gRPC:5679 + REST:5678
2025-06-24T19:18:49.707898Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:470: 🔗 Starting gRPC Server on port 5679
2025-06-24T19:18:49.707943Z  INFO proximadb::network::grpc::service: src/network/grpc/service.rs:135: 🚀 Creating ProximaDbGrpcService with shared services (multi-server pattern)
2025-06-24T19:18:49.708773Z DEBUG proximadb::network::multi_server: src/network/multi_server.rs:485: Adding gRPC reflection service
2025-06-24T19:18:49.710501Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:506: ✅ gRPC Server started on 0.0.0.0:5679
2025-06-24T19:18:49.710565Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:511: 📡 Starting REST Server on port 5678
2025-06-24T19:18:49.710722Z ERROR proximadb::network::multi_server: src/network/multi_server.rs:501: gRPC server error: transport error
2025-06-24T19:18:49.710815Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:531: ✅ REST Server started on 0.0.0.0:5678
2025-06-24T19:18:49.710903Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:536: 🎯 Multi-Server started successfully: gRPC:5679 + REST:5678
2025-06-24T19:18:49.710967Z  INFO proximadb_server: src/bin/server.rs:114: ProximaDB server started successfully
2025-06-24T19:18:49.711069Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:68: 🌐 Starting REST server on 0.0.0.0:5678
2025-06-24T19:18:49.711147Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:70: ✅ REST server listening on 0.0.0.0:5678
2025-06-24T19:18:49.711289Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:71: 📋 Available endpoints:
2025-06-24T19:18:49.711373Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:72:    GET    /health                           - Health check
2025-06-24T19:18:49.711459Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:73:    POST   /collections                      - Create collection
2025-06-24T19:18:49.711542Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:74:    GET    /collections                      - List collections
2025-06-24T19:18:49.711624Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:75:    GET    /collections/:id                  - Get collection
2025-06-24T19:18:49.711706Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:76:    DELETE /collections/:id                  - Delete collection
2025-06-24T19:18:49.711787Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:77:    POST   /collections/:id/vectors          - Insert vector
2025-06-24T19:18:49.711878Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:78:    GET    /collections/:id/vectors/:vid     - Get vector
2025-06-24T19:18:49.711959Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:79:    PUT    /collections/:id/vectors/:vid     - Update vector
2025-06-24T19:18:49.712045Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:80:    DELETE /collections/:id/vectors/:vid     - Delete vector
2025-06-24T19:18:49.712144Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:81:    POST   /collections/:id/search           - Search vectors
2025-06-24T19:18:49.712243Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:82:    POST   /collections/:id/vectors/batch    - Batch insert
2025-06-24T20:03:15.142698Z  INFO proximadb_server: src/bin/server.rs:78: 🔧 Initializing hardware detection...
2025-06-24T20:03:15.143910Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:175: 🔍 Detecting hardware capabilities...
2025-06-24T20:03:15.144026Z DEBUG proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:203: Detecting CPU capabilities...
2025-06-24T20:03:15.145857Z DEBUG proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:267: Detecting GPU capabilities...
2025-06-24T20:03:15.147693Z DEBUG proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:307: Detecting memory information...
2025-06-24T20:03:15.147967Z DEBUG proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:327: Determining optimization paths...
2025-06-24T20:03:15.148079Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:398: 🔧 Hardware Detection Complete:
2025-06-24T20:03:15.148217Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:399:   CPU: Unknown CPU (10 cores, 10 threads)
2025-06-24T20:03:15.148325Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:403:   SIMD: Neon (SSE:false AVX:false AVX2:false FMA:false)
2025-06-24T20:03:15.148402Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:426:   Preferred Backend: Cpu { simd_level: Neon }
2025-06-24T20:03:15.148517Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:427:   Bulk Insert Batch Size: 250
2025-06-24T20:03:15.148666Z  WARN proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:437: ⚠️  CPU lacks AVX support - performance may be limited
2025-06-24T20:03:15.149708Z  INFO proximadb_server: src/bin/server.rs:88: Configuration file not found, using defaults
2025-06-24T20:03:15.150079Z  INFO proximadb_server: src/bin/server.rs:103: Starting ProximaDB server with config: Config { server: ServerConfig { node_id: "proximadb-node-1", bind_address: "0.0.0.0", port: 5678, data_dir: "/data/proximadb/1" }, storage: StorageConfig { data_dirs: ["/data/proximadb/1", "/data/proximadb/2"], wal_dir: "/data/proximadb/1/wal", storage_layout: StorageLayoutConfig { base_paths: [StorageBasePath { base_dir: "/data/proximadb", instance_id: 1, mount_point: Some("/data"), disk_type: NvmeSsd { max_iops: 100000 }, capacity_config: CapacityConfig { max_wal_size_mb: Some(2048), max_storage_size_mb: None, metadata_reserved_mb: 512, warning_threshold_percent: 85.0 } }, StorageBasePath { base_dir: "/data/proximadb", instance_id: 2, mount_point: Some("/data2"), disk_type: SataSsd { max_iops: 75000 }, capacity_config: CapacityConfig { max_wal_size_mb: Some(2048), max_storage_size_mb: None, metadata_reserved_mb: 0, warning_threshold_percent: 85.0 } }], node_instance: 1, assignment_strategy: HashBased, temp_config: TempDirectoryConfig { use_same_directory: true, temp_suffix: "___temp", compaction_suffix: "___compaction", flush_suffix: "___flushed", cleanup_on_startup: true } }, mmap_enabled: true, lsm_config: LsmConfig { memtable_size_mb: 64, level_count: 7, compaction_threshold: 4, block_size_kb: 64 }, cache_size_mb: 2048, bloom_filter_bits: 12, filesystem_config: FilesystemConfig { enable_write_strategy_cache: true, temp_strategy: SameDirectory, atomic_config: AtomicOperationsConfig { enable_local_atomic: true, enable_object_store_atomic: true, cleanup_temp_on_startup: true } }, metadata_backend: None }, consensus: ConsensusConfig { node_id: Some(1), cluster_peers: [], election_timeout_ms: 5000, heartbeat_interval_ms: 1000, snapshot_threshold: 1000 }, api: ApiConfig { grpc_port: 5679, rest_port: 5678, max_request_size_mb: 64, timeout_seconds: 30, enable_tls: Some(false) }, monitoring: MonitoringConfig { metrics_enabled: true, log_level: "info" }, tls: None }
2025-06-24T20:03:15.150188Z  INFO proximadb: src/lib.rs:71: 🚀 ProximaDB::new - STARTING database initialization
2025-06-24T20:03:15.151277Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:177: 🚀 AvroWalStrategy::initialize - Starting initialization
2025-06-24T20:03:15.151384Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:178: 📋 Config details:
2025-06-24T20:03:15.151450Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:179:   - memtable_type: Art
2025-06-24T20:03:15.151556Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:180:   - compression: Snappy
2025-06-24T20:03:15.151657Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:181:   - memory_flush_size_bytes: 1048576
2025-06-24T20:03:15.151741Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:185:   - data_directories: 1 dirs
2025-06-24T20:03:15.151921Z  INFO proximadb::storage::wal::memtable::art: src/storage/wal/memtable/art.rs:451: ✅ ART (Adaptive Radix Tree) memtable initialized for space efficiency and high concurrency
2025-06-24T20:03:15.152893Z  INFO proximadb::storage::wal::avro: src/storage/wal/avro.rs:195: ✅ Avro WAL strategy initialized
2025-06-24T20:03:15.152989Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:196: ✅ AvroWalStrategy::initialize - Initialization complete
2025-06-24T20:03:15.153069Z DEBUG proximadb::storage::wal: src/storage/wal/mod.rs:228: 🚀 Creating WalManager with strategy: Avro
2025-06-24T20:03:15.153147Z DEBUG proximadb::storage::wal: src/storage/wal/mod.rs:232: 📋 WAL Config: strategy_type=Avro, memtable_type=Art
2025-06-24T20:03:15.153224Z DEBUG proximadb::storage::wal: src/storage/wal/mod.rs:237: 💾 Multi-disk config: 1 directories, distribution=LoadBalanced
2025-06-24T20:03:15.153358Z  INFO proximadb::storage::engine: src/storage/engine.rs:119: 📂 StorageEngine: Metadata operations delegated to SharedServices
2025-06-24T20:03:15.153468Z  INFO proximadb: src/lib.rs:73: ✅ ProximaDB::new - Storage engine created successfully
2025-06-24T20:03:15.153578Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:148: 📡 HTTP Server Configuration:
2025-06-24T20:03:15.153680Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:153:   🌐 Non-TLS Mode: ENABLED on 0.0.0.0:5678
2025-06-24T20:03:15.153759Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:162:   📍 Services: REST=true, Dashboard=true, Metrics=true, Health=true
2025-06-24T20:03:15.153855Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:301: 🔗 gRPC Server Configuration:
2025-06-24T20:03:15.153960Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:306:   🌐 Non-TLS Mode: ENABLED on 0.0.0.0:5679
2025-06-24T20:03:15.154039Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:315:   📍 Features: gRPC=true, Reflection=true, MaxMsgSize=4MB
2025-06-24T20:03:15.180393Z  INFO proximadb: src/lib.rs:112: 🔧 ProximaDB::new: Creating SharedServices with metadata config: None
2025-06-24T20:03:15.180623Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:294: 🔧 SharedServices: Initializing business logic hub for ALL protocols
2025-06-24T20:03:15.180709Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:340: 📂 SharedServices: Using default metadata configuration
2025-06-24T20:03:15.180789Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:344: 📁 SharedServices: Unified metadata backend URL: file://./data
2025-06-24T20:03:15.180906Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:333: 🗃️ Creating FilestoreMetadataBackend
2025-06-24T20:03:15.180989Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:334: 📁 Filestore URL: file://./data
2025-06-24T20:03:15.182500Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:345: 📁 FilestoreMetadataBackend: Working in root directory specified by URL: file://./data
2025-06-24T20:03:15.183631Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:385: 🔄 Starting ATOMIC recovery...
2025-06-24T20:03:15.183718Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:386: 📂 Filestore URL: file://./data
2025-06-24T20:03:15.183800Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:387: 📁 Metadata path: 
2025-06-24T20:03:15.183960Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:392: 🔒 Recovery lock acquired - API requests blocked
2025-06-24T20:03:15.184044Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:398: 📸 Loading latest snapshot...
2025-06-24T20:03:15.184149Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:434: 📁 Snapshot path: snapshots/current_collections.avro
2025-06-24T20:03:15.184409Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:439: 📄 Snapshot file exists, reading...
2025-06-24T20:03:15.184765Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:441: 📊 Snapshot file size: 0 bytes
2025-06-24T20:03:15.184852Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:457: 📭 Snapshot file is empty
2025-06-24T20:03:15.184930Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:400: 📸 Loaded 0 collections from snapshot
2025-06-24T20:03:15.185014Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:406: 🔄 Replaying incremental operations...
2025-06-24T20:03:15.185488Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:408: 🔄 Replayed 0 operations
2025-06-24T20:03:15.185574Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:409: 📊 Final memtable size: 0
2025-06-24T20:03:15.185671Z  INFO proximadb::storage::metadata::single_index: src/storage/metadata/single_index.rs:244: SingleCollectionIndex rebuilt with 0 collections
2025-06-24T20:03:15.188454Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:619: 💾 Atomic write with optimized strategy: snapshots/current_collections.avro
2025-06-24T20:03:15.189020Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:621: ✅ Optimized atomic write completed
2025-06-24T20:03:15.189232Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:426: ✅ Recovery completed in 5.223792ms
2025-06-24T20:03:15.189315Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:379: ✅ FilestoreMetadataBackend initialized
2025-06-24T20:03:15.189393Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:146: 🏗️ Creating UnifiedAvroService with shared WAL manager
2025-06-24T20:03:15.189477Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:147: 🔧 WAL Strategy: Avro, Memtable: BTree
2025-06-24T20:03:15.189615Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:89: 🚀 Initializing UnifiedAvroService with binary Avro operations
2025-06-24T20:03:15.189699Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:90: 📋 Service Config: WAL strategy=Avro, memtable=BTree, schema_version=1
2025-06-24T20:03:15.189774Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:157: 🔧 Creating Vector Storage Coordinator with VIPER engine
2025-06-24T20:03:15.190052Z  INFO proximadb::storage::vector::coordinator: src/storage/vector/coordinator.rs:356: 🔧 Registered storage engine: VIPER
2025-06-24T20:03:15.190135Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:184: ✅ Vector Storage Coordinator created with VIPER engine
2025-06-24T20:03:15.190211Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:370: 🔄 SharedServices: Starting metadata recovery from WAL
2025-06-24T20:03:15.190292Z  INFO proximadb::storage::engine: src/storage/engine.rs:430: 📊 Extracting collection metadata from recovered WAL entries
2025-06-24T20:03:15.190416Z  INFO proximadb::storage::engine: src/storage/engine.rs:438: 📊 WAL stats: 0 total entries across 0 collections
2025-06-24T20:03:15.190501Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection test_persistence_collection_1 from memtable
2025-06-24T20:03:15.190572Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection test_persistence_collection_2 from memtable
2025-06-24T20:03:15.190659Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection embeddings from memtable
2025-06-24T20:03:15.190734Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection documents from memtable
2025-06-24T20:03:15.190820Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection vectors from memtable
2025-06-24T20:03:15.190907Z  INFO proximadb::storage::engine: src/storage/engine.rs:494: ✅ Extracted metadata for 0 collections from WAL
2025-06-24T20:03:15.190995Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:415: 📋 SharedServices: No collections found in WAL to restore
2025-06-24T20:03:15.191063Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:418: ✅ SharedServices: Business logic hub ready for ALL protocols (gRPC, REST, WebSocket, etc.)
2025-06-24T20:03:15.191129Z  INFO proximadb: src/lib.rs:119: ✅ ProximaDB::new: SharedServices created successfully
2025-06-24T20:03:15.191192Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:449: 🚀 MultiServer: Initializing network orchestrator
2025-06-24T20:03:15.191255Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:450: 📡 MultiServer: gRPC port: 5679, REST port: 5678
2025-06-24T20:03:15.191377Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:452: 🔒 MultiServer: TLS enabled: false
2025-06-24T20:03:15.191450Z  INFO proximadb::storage::engine: src/storage/engine.rs:408: 🔄 Starting WAL recovery
2025-06-24T20:03:15.191540Z  INFO proximadb::storage::wal::avro: src/storage/wal/avro.rs:582: 🔄 WAL RECOVERY: Starting Avro WAL recovery
2025-06-24T20:03:15.191634Z  INFO proximadb::storage::wal::avro: src/storage/wal/avro.rs:587: 📂 WAL RECOVERY: Found 0 collections to recover
2025-06-24T20:03:15.191705Z  INFO proximadb::storage::wal::avro: src/storage/wal/avro.rs:618: ✅ WAL RECOVERY: Recovered 0 total entries from disk
2025-06-24T20:03:15.191771Z  INFO proximadb::storage::engine: src/storage/engine.rs:413: ✅ WAL recovery completed successfully, recovered 0 entries
2025-06-24T20:03:15.192053Z DEBUG proximadb::storage::engine: src/storage/engine.rs:399: TODO: Initialize search index for collection wal via SharedServices
2025-06-24T20:03:15.192218Z  INFO proximadb::storage::engine: src/storage/engine.rs:585: 🔍 Preloading collection metadata cache...
2025-06-24T20:03:15.192303Z  INFO proximadb::storage::engine: src/storage/engine.rs:595: 🔍 Preloaded 0 collections into metadata cache
2025-06-24T20:03:15.192377Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:463: 🚀 Starting ProximaDB Multi-Server: gRPC:5679 + REST:5678
2025-06-24T20:03:15.192469Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:470: 🔗 Starting gRPC Server on port 5679
2025-06-24T20:03:15.192549Z  INFO proximadb::network::grpc::service: src/network/grpc/service.rs:135: 🚀 Creating ProximaDbGrpcService with shared services (multi-server pattern)
2025-06-24T20:03:15.193567Z DEBUG proximadb::network::multi_server: src/network/multi_server.rs:485: Adding gRPC reflection service
2025-06-24T20:03:15.195443Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:506: ✅ gRPC Server started on 0.0.0.0:5679
2025-06-24T20:03:15.195596Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:511: 📡 Starting REST Server on port 5678
2025-06-24T20:03:15.195708Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:531: ✅ REST Server started on 0.0.0.0:5678
2025-06-24T20:03:15.195811Z ERROR proximadb::network::multi_server: src/network/multi_server.rs:501: gRPC server error: transport error
2025-06-24T20:03:15.195976Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:536: 🎯 Multi-Server started successfully: gRPC:5679 + REST:5678
2025-06-24T20:03:15.196068Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:68: 🌐 Starting REST server on 0.0.0.0:5678
2025-06-24T20:03:15.196145Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:70: ✅ REST server listening on 0.0.0.0:5678
2025-06-24T20:03:15.196234Z  INFO proximadb_server: src/bin/server.rs:114: ProximaDB server started successfully
2025-06-24T20:03:15.196377Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:71: 📋 Available endpoints:
2025-06-24T20:03:15.196471Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:72:    GET    /health                           - Health check
2025-06-24T20:03:15.196563Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:73:    POST   /collections                      - Create collection
2025-06-24T20:03:15.196637Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:74:    GET    /collections                      - List collections
2025-06-24T20:03:15.196726Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:75:    GET    /collections/:id                  - Get collection
2025-06-24T20:03:15.196828Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:76:    DELETE /collections/:id                  - Delete collection
2025-06-24T20:03:15.196913Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:77:    POST   /collections/:id/vectors          - Insert vector
2025-06-24T20:03:15.196993Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:78:    GET    /collections/:id/vectors/:vid     - Get vector
2025-06-24T20:03:15.197066Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:79:    PUT    /collections/:id/vectors/:vid     - Update vector
2025-06-24T20:03:15.197144Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:80:    DELETE /collections/:id/vectors/:vid     - Delete vector
2025-06-24T20:03:15.197228Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:81:    POST   /collections/:id/search           - Search vectors
2025-06-24T20:03:15.197308Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:82:    POST   /collections/:id/vectors/batch    - Batch insert
2025-06-24T20:06:09.956204Z  INFO proximadb_server: src/bin/server.rs:78: 🔧 Initializing hardware detection...
2025-06-24T20:06:09.957452Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:175: 🔍 Detecting hardware capabilities...
2025-06-24T20:06:09.957556Z DEBUG proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:203: Detecting CPU capabilities...
2025-06-24T20:06:09.959259Z DEBUG proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:267: Detecting GPU capabilities...
2025-06-24T20:06:09.961104Z DEBUG proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:307: Detecting memory information...
2025-06-24T20:06:09.961357Z DEBUG proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:327: Determining optimization paths...
2025-06-24T20:06:09.961462Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:398: 🔧 Hardware Detection Complete:
2025-06-24T20:06:09.961638Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:399:   CPU: Unknown CPU (10 cores, 10 threads)
2025-06-24T20:06:09.961748Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:403:   SIMD: Neon (SSE:false AVX:false AVX2:false FMA:false)
2025-06-24T20:06:09.961826Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:426:   Preferred Backend: Cpu { simd_level: Neon }
2025-06-24T20:06:09.961914Z  INFO proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:427:   Bulk Insert Batch Size: 250
2025-06-24T20:06:09.961993Z  WARN proximadb::compute::hardware_detection: src/compute/hardware_detection.rs:437: ⚠️  CPU lacks AVX support - performance may be limited
2025-06-24T20:06:09.963059Z  INFO proximadb_server: src/bin/server.rs:88: Configuration file not found, using defaults
2025-06-24T20:06:09.963466Z  INFO proximadb_server: src/bin/server.rs:103: Starting ProximaDB server with config: Config { server: ServerConfig { node_id: "proximadb-node-1", bind_address: "0.0.0.0", port: 5678, data_dir: "/data/proximadb/1" }, storage: StorageConfig { data_dirs: ["/data/proximadb/1", "/data/proximadb/2"], wal_dir: "/data/proximadb/1/wal", storage_layout: StorageLayoutConfig { base_paths: [StorageBasePath { base_dir: "/data/proximadb", instance_id: 1, mount_point: Some("/data"), disk_type: NvmeSsd { max_iops: 100000 }, capacity_config: CapacityConfig { max_wal_size_mb: Some(2048), max_storage_size_mb: None, metadata_reserved_mb: 512, warning_threshold_percent: 85.0 } }, StorageBasePath { base_dir: "/data/proximadb", instance_id: 2, mount_point: Some("/data2"), disk_type: SataSsd { max_iops: 75000 }, capacity_config: CapacityConfig { max_wal_size_mb: Some(2048), max_storage_size_mb: None, metadata_reserved_mb: 0, warning_threshold_percent: 85.0 } }], node_instance: 1, assignment_strategy: HashBased, temp_config: TempDirectoryConfig { use_same_directory: true, temp_suffix: "___temp", compaction_suffix: "___compaction", flush_suffix: "___flushed", cleanup_on_startup: true } }, mmap_enabled: true, lsm_config: LsmConfig { memtable_size_mb: 64, level_count: 7, compaction_threshold: 4, block_size_kb: 64 }, cache_size_mb: 2048, bloom_filter_bits: 12, filesystem_config: FilesystemConfig { enable_write_strategy_cache: true, temp_strategy: SameDirectory, atomic_config: AtomicOperationsConfig { enable_local_atomic: true, enable_object_store_atomic: true, cleanup_temp_on_startup: true } }, metadata_backend: None }, consensus: ConsensusConfig { node_id: Some(1), cluster_peers: [], election_timeout_ms: 5000, heartbeat_interval_ms: 1000, snapshot_threshold: 1000 }, api: ApiConfig { grpc_port: 5679, rest_port: 5678, max_request_size_mb: 64, timeout_seconds: 30, enable_tls: Some(false) }, monitoring: MonitoringConfig { metrics_enabled: true, log_level: "info" }, tls: None }
2025-06-24T20:06:09.963567Z  INFO proximadb: src/lib.rs:71: 🚀 ProximaDB::new - STARTING database initialization
2025-06-24T20:06:09.964631Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:177: 🚀 AvroWalStrategy::initialize - Starting initialization
2025-06-24T20:06:09.964726Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:178: 📋 Config details:
2025-06-24T20:06:09.964800Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:179:   - memtable_type: Art
2025-06-24T20:06:09.964888Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:180:   - compression: Snappy
2025-06-24T20:06:09.964957Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:181:   - memory_flush_size_bytes: 1048576
2025-06-24T20:06:09.965046Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:185:   - data_directories: 1 dirs
2025-06-24T20:06:09.965249Z  INFO proximadb::storage::wal::memtable::art: src/storage/wal/memtable/art.rs:451: ✅ ART (Adaptive Radix Tree) memtable initialized for space efficiency and high concurrency
2025-06-24T20:06:09.966300Z  INFO proximadb::storage::wal::avro: src/storage/wal/avro.rs:195: ✅ Avro WAL strategy initialized
2025-06-24T20:06:09.966392Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:196: ✅ AvroWalStrategy::initialize - Initialization complete
2025-06-24T20:06:09.966480Z DEBUG proximadb::storage::wal: src/storage/wal/mod.rs:228: 🚀 Creating WalManager with strategy: Avro
2025-06-24T20:06:09.966555Z DEBUG proximadb::storage::wal: src/storage/wal/mod.rs:232: 📋 WAL Config: strategy_type=Avro, memtable_type=Art
2025-06-24T20:06:09.966634Z DEBUG proximadb::storage::wal: src/storage/wal/mod.rs:237: 💾 Multi-disk config: 1 directories, distribution=LoadBalanced
2025-06-24T20:06:09.966781Z  INFO proximadb::storage::engine: src/storage/engine.rs:119: 📂 StorageEngine: Metadata operations delegated to SharedServices
2025-06-24T20:06:09.966869Z  INFO proximadb: src/lib.rs:73: ✅ ProximaDB::new - Storage engine created successfully
2025-06-24T20:06:09.966977Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:148: 📡 HTTP Server Configuration:
2025-06-24T20:06:09.967090Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:153:   🌐 Non-TLS Mode: ENABLED on 0.0.0.0:5678
2025-06-24T20:06:09.967169Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:162:   📍 Services: REST=true, Dashboard=true, Metrics=true, Health=true
2025-06-24T20:06:09.967244Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:301: 🔗 gRPC Server Configuration:
2025-06-24T20:06:09.967331Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:306:   🌐 Non-TLS Mode: ENABLED on 0.0.0.0:5679
2025-06-24T20:06:09.967428Z  INFO proximadb::network::server_builder: src/network/server_builder.rs:315:   📍 Features: gRPC=true, Reflection=true, MaxMsgSize=4MB
2025-06-24T20:06:09.979472Z  INFO proximadb: src/lib.rs:112: 🔧 ProximaDB::new: Creating SharedServices with metadata config: None
2025-06-24T20:06:09.979718Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:294: 🔧 SharedServices: Initializing business logic hub for ALL protocols
2025-06-24T20:06:09.979803Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:340: 📂 SharedServices: Using default metadata configuration
2025-06-24T20:06:09.979878Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:344: 📁 SharedServices: Unified metadata backend URL: file://./data
2025-06-24T20:06:09.979978Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:333: 🗃️ Creating FilestoreMetadataBackend
2025-06-24T20:06:09.980065Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:334: 📁 Filestore URL: file://./data
2025-06-24T20:06:09.981534Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:345: 📁 FilestoreMetadataBackend: Working in root directory specified by URL: file://./data
2025-06-24T20:06:09.982662Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:385: 🔄 Starting ATOMIC recovery...
2025-06-24T20:06:09.982748Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:386: 📂 Filestore URL: file://./data
2025-06-24T20:06:09.982825Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:387: 📁 Metadata path: 
2025-06-24T20:06:09.982911Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:392: 🔒 Recovery lock acquired - API requests blocked
2025-06-24T20:06:09.983069Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:398: 📸 Loading latest snapshot...
2025-06-24T20:06:09.983185Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:434: 📁 Snapshot path: snapshots/current_collections.avro
2025-06-24T20:06:09.983366Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:439: 📄 Snapshot file exists, reading...
2025-06-24T20:06:09.983698Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:441: 📊 Snapshot file size: 0 bytes
2025-06-24T20:06:09.983783Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:457: 📭 Snapshot file is empty
2025-06-24T20:06:09.983861Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:400: 📸 Loaded 0 collections from snapshot
2025-06-24T20:06:09.983934Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:406: 🔄 Replaying incremental operations...
2025-06-24T20:06:09.984379Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:408: 🔄 Replayed 0 operations
2025-06-24T20:06:09.984463Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:409: 📊 Final memtable size: 0
2025-06-24T20:06:09.984577Z  INFO proximadb::storage::metadata::single_index: src/storage/metadata/single_index.rs:244: SingleCollectionIndex rebuilt with 0 collections
2025-06-24T20:06:09.987567Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:619: 💾 Atomic write with optimized strategy: snapshots/current_collections.avro
2025-06-24T20:06:09.988143Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:621: ✅ Optimized atomic write completed
2025-06-24T20:06:09.988360Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:426: ✅ Recovery completed in 5.324958ms
2025-06-24T20:06:09.988438Z  INFO proximadb::storage::metadata::backends::filestore_backend: src/storage/metadata/backends/filestore_backend.rs:379: ✅ FilestoreMetadataBackend initialized
2025-06-24T20:06:09.988530Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:146: 🏗️ Creating UnifiedAvroService with shared WAL manager
2025-06-24T20:06:09.988626Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:147: 🔧 WAL Strategy: Avro, Memtable: BTree
2025-06-24T20:06:09.988680Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:89: 🚀 Initializing UnifiedAvroService with binary Avro operations
2025-06-24T20:06:09.988784Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:90: 📋 Service Config: WAL strategy=Avro, memtable=BTree, schema_version=1
2025-06-24T20:06:09.988877Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:157: 🔧 Creating Vector Storage Coordinator with VIPER engine
2025-06-24T20:06:09.989246Z  INFO proximadb::storage::vector::coordinator: src/storage/vector/coordinator.rs:356: 🔧 Registered storage engine: VIPER
2025-06-24T20:06:09.989340Z  INFO proximadb::services::unified_avro_service: src/services/unified_avro_service.rs:184: ✅ Vector Storage Coordinator created with VIPER engine
2025-06-24T20:06:09.989429Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:370: 🔄 SharedServices: Starting metadata recovery from WAL
2025-06-24T20:06:09.989505Z  INFO proximadb::storage::engine: src/storage/engine.rs:430: 📊 Extracting collection metadata from recovered WAL entries
2025-06-24T20:06:09.989675Z  INFO proximadb::storage::engine: src/storage/engine.rs:438: 📊 WAL stats: 0 total entries across 0 collections
2025-06-24T20:06:09.989784Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection test_persistence_collection_1 from memtable
2025-06-24T20:06:09.989889Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection test_persistence_collection_2 from memtable
2025-06-24T20:06:09.989993Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection embeddings from memtable
2025-06-24T20:06:09.990066Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection documents from memtable
2025-06-24T20:06:09.990176Z DEBUG proximadb::storage::wal::avro: src/storage/wal/avro.rs:404: 📋 Getting all entries for collection vectors from memtable
2025-06-24T20:06:09.990260Z  INFO proximadb::storage::engine: src/storage/engine.rs:494: ✅ Extracted metadata for 0 collections from WAL
2025-06-24T20:06:09.990351Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:415: 📋 SharedServices: No collections found in WAL to restore
2025-06-24T20:06:09.990457Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:418: ✅ SharedServices: Business logic hub ready for ALL protocols (gRPC, REST, WebSocket, etc.)
2025-06-24T20:06:09.990545Z  INFO proximadb: src/lib.rs:119: ✅ ProximaDB::new: SharedServices created successfully
2025-06-24T20:06:09.990628Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:449: 🚀 MultiServer: Initializing network orchestrator
2025-06-24T20:06:09.990733Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:450: 📡 MultiServer: gRPC port: 5679, REST port: 5678
2025-06-24T20:06:09.990884Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:452: 🔒 MultiServer: TLS enabled: false
2025-06-24T20:06:09.990976Z  INFO proximadb::storage::engine: src/storage/engine.rs:408: 🔄 Starting WAL recovery
2025-06-24T20:06:09.991056Z  INFO proximadb::storage::wal::avro: src/storage/wal/avro.rs:582: 🔄 WAL RECOVERY: Starting Avro WAL recovery
2025-06-24T20:06:09.991140Z  INFO proximadb::storage::wal::avro: src/storage/wal/avro.rs:587: 📂 WAL RECOVERY: Found 0 collections to recover
2025-06-24T20:06:09.991224Z  INFO proximadb::storage::wal::avro: src/storage/wal/avro.rs:618: ✅ WAL RECOVERY: Recovered 0 total entries from disk
2025-06-24T20:06:09.991323Z  INFO proximadb::storage::engine: src/storage/engine.rs:413: ✅ WAL recovery completed successfully, recovered 0 entries
2025-06-24T20:06:09.991614Z DEBUG proximadb::storage::engine: src/storage/engine.rs:399: TODO: Initialize search index for collection wal via SharedServices
2025-06-24T20:06:09.991780Z  INFO proximadb::storage::engine: src/storage/engine.rs:585: 🔍 Preloading collection metadata cache...
2025-06-24T20:06:09.991860Z  INFO proximadb::storage::engine: src/storage/engine.rs:595: 🔍 Preloaded 0 collections into metadata cache
2025-06-24T20:06:09.991967Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:463: 🚀 Starting ProximaDB Multi-Server: gRPC:5679 + REST:5678
2025-06-24T20:06:09.992085Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:470: 🔗 Starting gRPC Server on port 5679
2025-06-24T20:06:09.992219Z  INFO proximadb::network::grpc::service: src/network/grpc/service.rs:135: 🚀 Creating ProximaDbGrpcService with shared services (multi-server pattern)
2025-06-24T20:06:09.993513Z DEBUG proximadb::network::multi_server: src/network/multi_server.rs:485: Adding gRPC reflection service
2025-06-24T20:06:09.995472Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:506: ✅ gRPC Server started on 0.0.0.0:5679
2025-06-24T20:06:09.995582Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:511: 📡 Starting REST Server on port 5678
2025-06-24T20:06:09.995718Z ERROR proximadb::network::multi_server: src/network/multi_server.rs:501: gRPC server error: transport error
2025-06-24T20:06:09.995844Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:531: ✅ REST Server started on 0.0.0.0:5678
2025-06-24T20:06:09.995926Z  INFO proximadb::network::multi_server: src/network/multi_server.rs:536: 🎯 Multi-Server started successfully: gRPC:5679 + REST:5678
2025-06-24T20:06:09.996048Z  INFO proximadb_server: src/bin/server.rs:114: ProximaDB server started successfully
2025-06-24T20:06:09.996123Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:68: 🌐 Starting REST server on 0.0.0.0:5678
2025-06-24T20:06:09.996234Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:70: ✅ REST server listening on 0.0.0.0:5678
2025-06-24T20:06:09.996403Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:71: 📋 Available endpoints:
2025-06-24T20:06:09.996500Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:72:    GET    /health                           - Health check
2025-06-24T20:06:09.996626Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:73:    POST   /collections                      - Create collection
2025-06-24T20:06:09.996750Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:74:    GET    /collections                      - List collections
2025-06-24T20:06:09.996838Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:75:    GET    /collections/:id                  - Get collection
2025-06-24T20:06:09.996966Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:76:    DELETE /collections/:id                  - Delete collection
2025-06-24T20:06:09.997096Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:77:    POST   /collections/:id/vectors          - Insert vector
2025-06-24T20:06:09.997201Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:78:    GET    /collections/:id/vectors/:vid     - Get vector
2025-06-24T20:06:09.997290Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:79:    PUT    /collections/:id/vectors/:vid     - Update vector
2025-06-24T20:06:09.997396Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:80:    DELETE /collections/:id/vectors/:vid     - Delete vector
2025-06-24T20:06:09.997484Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:81:    POST   /collections/:id/search           - Search vectors
2025-06-24T20:06:09.997562Z  INFO proximadb::network::rest::server: src/network/rest/server.rs:82:    POST   /collections/:id/vectors/batch    - Batch insert
